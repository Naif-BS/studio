(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[372],{255:(e,t,a)=>{"use strict";function r(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return r}}),a(5155),a(7650),a(5744),a(589)},283:(e,t,a)=>{"use strict";a.d(t,{A:()=>u,AuthProvider:()=>d});var r=a(5155),s=a(2115),n=a(3004),i=a(6104),l=a(7481);let o={uid:"mock-uid",email:"mock@example.com",displayName:"Mock User",emailVerified:!0,isAnonymous:!1,phoneNumber:null,photoURL:null,providerData:[],tenantId:null,refreshToken:"mock-refresh-token",metadata:{creationTime:new Date().toISOString(),lastSignInTime:new Date().toISOString()},providerId:"firebase",delete:async()=>{},getIdToken:async()=>"mock-id-token",getIdTokenResult:async()=>({token:"mock-id-token",claims:{},expirationTime:new Date(Date.now()+36e5).toISOString(),issuedAtTime:new Date().toISOString(),authTime:new Date().toISOString(),signInProvider:null,signInSecondFactor:null}),reload:async()=>{},toJSON:()=>({})},c=(0,s.createContext)(void 0),d=e=>{let{children:t}=e,[a,d]=(0,s.useState)(null),[u,f]=(0,s.useState)(!1),[m,p]=(0,s.useState)(!0),[h,g]=(0,s.useState)(null),{toast:v}=(0,l.dj)(),x=(0,n.xI)(i.y);(0,s.useEffect)(()=>{let e=(0,n.hg)(x,e=>{e?(d(e),f(!0)):(d(null),f(!1)),p(!1)});return()=>e()},[x]);let y=async(e,t)=>{g(null),p(!0);try{await (0,n.x9)(x,e,t),v({title:"Logged In Successfully!",description:"Welcome back to MediaScope.",variant:"default"})}catch(e){g(e.message),v({title:"Login Failed",description:e.message,variant:"destructive"}),console.error("Login error:",e)}finally{p(!1)}},b=async(e,t,a)=>{g(null),p(!0);try{let r=await (0,n.eJ)(x,e,t);r.user&&(await (0,n.r7)(r.user,{displayName:a}),d(r.user),f(!0),v({title:"Account Created!",description:"Welcome to MediaScope. Your account has been successfully created.",variant:"default"}))}catch(e){g(e.message),v({title:"Signup Failed",description:e.message,variant:"destructive"}),console.error("Signup error:",e)}finally{p(!1)}},j=async()=>{g(null),p(!0);try{await (0,n.CI)(x),v({title:"Logged Out",description:"You have been successfully logged out.",variant:"default"})}catch(e){g(e.message),v({title:"Logout Failed",description:e.message,variant:"destructive"}),console.error("Logout error:",e)}finally{p(!1)}};return(0,r.jsx)(c.Provider,{value:{user:a||o,isAuthenticated:u,isLoading:m,error:h,login:y,signup:b,logout:j},children:t})},u=()=>{let e=(0,s.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},773:(e,t,a)=>{Promise.resolve().then(a.bind(a,7136))},2146:(e,t,a)=>{"use strict";function r(e){let{reason:t,children:a}=e;return a}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return r}}),a(5262)},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{bindSnapshot:function(){return i},createAsyncLocalStorage:function(){return n},createSnapshot:function(){return l}});let a=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class r{disable(){throw a}getStore(){}run(){throw a}exit(){throw a}enterWith(){throw a}static bind(e){return e}}let s="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function n(){return s?new s:new r}function i(e){return s?s.bind(e):r.bind(e)}function l(){return s?s.snapshot():function(e,...t){return e(...t)}}},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},5744:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return r.workAsyncStorageInstance}});let r=a(7828)},6104:(e,t,a)=>{"use strict";a.d(t,{y:()=>s});var r=a(3915);let s=(0,r.Dk)().length?(0,r.Sx)():(0,r.Wp)({apiKey:"AIzaSyDluqLuKutYp0PrJOjVDFpSuef4rGtkBXg",authDomain:"mediascope-vimbd.firebaseapp.com",projectId:"mediascope-vimbd",storageBucket:"mediascope-vimbd.firebasestorage.app",messagingSenderId:"28020752153",appId:"1:28020752153:web:fe2dd484777670e8cacf88"})},6645:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let r=a(8229)._(a(7357));function s(e,t){var a;let s={};"function"==typeof e&&(s.loader=e);let n={...s,...t};return(0,r.default)({...n,modules:null==(a=n.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>c,Wu:()=>d,ZB:()=>o,Zp:()=>i,aR:()=>l,wL:()=>u});var r=a(5155),s=a(2115),n=a(9434);let i=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});i.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...s})});l.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-2xl font-bold leading-none tracking-tight",a),...s})});o.displayName="CardTitle";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...s})});c.displayName="CardDescription";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...s})});d.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...s})});u.displayName="CardFooter"},7136:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var r=a(5155),s=a(2115),n=a(1308),i=a(6645),l=a.n(i),o=a(3211),c=a(3473),d=a(3717),u=a(7481),f=a(283),m=a(5695),p=a(6695);let h=(0,a(157).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var g=a(8856),v=a(9100);function x(){let[e,t]=(0,s.useState)([]),[i,x]=(0,s.useState)(null),[y,b]=(0,s.useState)(!0),[j,w]=(0,s.useState)(!1),{toast:N}=(0,u.dj)(),{user:S}=(0,f.A)(),k=(0,m.useSearchParams)(),P=(0,m.useRouter)(),I=k.get("ticketId"),[O,_]=(0,s.useState)({status:"",mediaMaterial:"",platform:"",searchTerm:""}),C=(0,s.useCallback)(async()=>{b(!0),await new Promise(e=>setTimeout(e,300)),t((0,c.oP)()),b(!1)},[]);(0,s.useEffect)(()=>{C()},[C]);let E=async(e,a,r)=>{if(!S)return;w(!0);let s=(0,c.iD)(e,a,r);s?(t(t=>t.map(t=>t.id===e?s:t)),(null==i?void 0:i.id)===e&&x(s),N({title:"Incident Status Updated",description:"Incident ".concat(s.serialNumber," status changed to ").concat(d.Z7[s.status],".")})):N({title:"Error",description:"Failed to update incident status.",variant:"destructive"}),w(!1)},A=async(a,r)=>{let s=(null==S?void 0:S.displayName)||"User",n=e.find(e=>e.id===a);if(!n){N({title:"Error",description:"Incident not found.",variant:"destructive"});return}w(!0);let l=(0,c.M8)(a,r,s);if(l){if(N({title:"Action Logged",description:"New action added to incident."}),"New"===n.status){let e=(0,c.iD)(a,"Processing","Status automatically changed to Processing by ".concat(s," after action was logged."));e?(l=e,N({title:"Incident Status Updated",description:"Incident ".concat(l.serialNumber," status automatically changed to ").concat(d.Z7[l.status],".")})):N({title:"Error",description:"Failed to automatically update incident status after logging action.",variant:"destructive"})}l&&(t(e=>e.map(e=>e.id===a?l:e)),(null==i?void 0:i.id)===a&&x(l))}else N({title:"Error",description:"Failed to log action for incident.",variant:"destructive"});w(!1)},M=(0,s.useMemo)(()=>e.filter(e=>"Closed"!==e.status).filter(e=>{var t;let a=(null===(t=O.searchTerm)||void 0===t?void 0:t.toLowerCase())||"";return(O.status&&("New"===O.status||"Processing"===O.status)?e.status===O.status:"New"===e.status||"Processing"===e.status)&&(!O.mediaMaterial||e.mediaMaterial===O.mediaMaterial)&&(!O.platform||e.platform===O.platform)&&(!O.searchTerm||e.serialNumber.toLowerCase().includes(a)||e.description.toLowerCase().includes(a))}).sort((e,t)=>{let a={New:1,Processing:2};return a[e.status]!==a[t.status]?a[e.status]-a[t.status]:new Date(e.receivedAt).getTime()-new Date(t.receivedAt).getTime()}),[e,O]);(0,s.useEffect)(()=>{if(!y){let e=i,t=I;if(i&&!M.find(e=>e.id===i.id))t=(e=M[0]||null)?e.id:null;else if(!i&&I){let a=M.find(e=>e.id===I);e=a||null,a||(t=null)}else i||I||!(M.length>0)?i&&i.id!==I?t=M.find(e=>e.id===i.id)?i.id:(e=M[0]||null)?e.id:null:!i&&0===M.length&&I&&(t=null):t=(e=M[0]).id;(null==i?void 0:i.id)!==(null==e?void 0:e.id)&&x(e);let a="/operation-room",r=t?"".concat(a,"?ticketId=").concat(t):a;r!==(I?"".concat(a,"?ticketId=").concat(I):a)&&P.replace(r,{scroll:!1})}},[M,i,y,P,I]);let R=l()(()=>Promise.all([a.e(19),a.e(794)]).then(a.bind(a,6794)),{loadableGenerated:{webpack:()=>[6794]},loading:()=>(0,r.jsx)(T,{})}),T=()=>(0,r.jsxs)(p.Zp,{className:"h-full p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsx)(g.E,{className:"h-8 w-1/3"}),(0,r.jsx)(g.E,{className:"h-6 w-20"})]}),(0,r.jsx)(g.E,{className:"h-4 w-1/2"}),(0,r.jsx)(v.w,{}),(0,r.jsx)(g.E,{className:"h-5 w-1/4 mb-1"}),(0,r.jsx)(g.E,{className:"h-4 w-full"}),(0,r.jsx)(g.E,{className:"h-4 w-full"}),(0,r.jsx)(g.E,{className:"h-4 w-3/4"}),(0,r.jsx)(v.w,{}),(0,r.jsx)(g.E,{className:"h-5 w-1/4 mb-2"}),(0,r.jsx)("div",{className:"space-y-3",children:[1,2].map(e=>(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)(g.E,{className:"h-3 w-1/4"}),(0,r.jsx)(g.E,{className:"h-3 w-1/3"})]}),(0,r.jsx)(g.E,{className:"h-4 w-full"})]},e))})]});return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Incident Management Center"})}),(0,r.jsx)(o.A,{filters:O,onFilterChange:_}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2",children:[(0,r.jsx)("h2",{className:"text-xl font-bold tracking-tight mb-3",children:"Incident Queue"}),(0,r.jsx)(n.A,{tickets:M,isLoading:y,onRowClick:t=>{let a=e.find(e=>e.id===t);x(a||null),a&&I!==a.id?P.push("/operation-room?ticketId=".concat(t),{scroll:!1}):!a&&I&&P.push("/operation-room",{scroll:!1})},visibleColumns:["SerialNumber","Status","Description","Media Material","Media Platform","ReportedBy"],showActionsColumn:!0})]}),(0,r.jsxs)("div",{className:"lg:col-span-1",children:[(0,r.jsx)("h2",{className:"text-xl font-bold tracking-tight mb-3",children:"Incident Details"}),y&&!i?(0,r.jsx)(T,{}):i?(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)(T,{}),children:(0,r.jsx)(R,{ticket:i,onUpdateStatus:E,onAddAction:A,isUpdating:j})}):(0,r.jsx)(p.Zp,{className:"h-full flex items-center justify-center min-h-[300px] bg-muted/20 border-dashed",children:(0,r.jsxs)("div",{className:"text-center text-muted-foreground p-6",children:[(0,r.jsx)(h,{className:"mx-auto h-12 w-12 mb-3"}),(0,r.jsx)("p",{className:"text-lg",children:"No incident selected."}),(0,r.jsx)("p",{children:"Select an incident from the queue to view its details and manage it. If the queue appears empty, please check your filters."})]})})]})]})]})}},7357:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let r=a(5155),s=a(2115),n=a(2146);function i(e){return{default:e&&"default"in e?e.default:e}}a(255);let l={loader:()=>Promise.resolve(i(()=>null)),loading:null,ssr:!0},o=function(e){let t={...l,...e},a=(0,s.lazy)(()=>t.loader().then(i)),o=t.loading;function c(e){let i=o?(0,r.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,l=!t.ssr||!!t.loading,c=l?s.Suspense:s.Fragment,d=t.ssr?(0,r.jsxs)(r.Fragment,{children:[null,(0,r.jsx)(a,{...e})]}):(0,r.jsx)(n.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(a,{...e})});return(0,r.jsx)(c,{...l?{fallback:i}:{},children:d})}return c.displayName="LoadableComponent",c}},7828:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return r}});let r=(0,a(4054).createAsyncLocalStorage)()},8856:(e,t,a)=>{"use strict";a.d(t,{E:()=>n});var r=a(5155),s=a(9434);function n(e){let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-muted",t),...a})}},9100:(e,t,a)=>{"use strict";a.d(t,{w:()=>d});var r=a(5155),s=a(2115),n=a(3655),i="horizontal",l=["horizontal","vertical"],o=s.forwardRef((e,t)=>{var a;let{decorative:s,orientation:o=i,...c}=e,d=(a=o,l.includes(a))?o:i;return(0,r.jsx)(n.sG.div,{"data-orientation":d,...s?{role:"none"}:{"aria-orientation":"vertical"===d?d:void 0,role:"separator"},...c,ref:t})});o.displayName="Separator";var c=a(9434);let d=s.forwardRef((e,t)=>{let{className:a,orientation:s="horizontal",decorative:n=!0,...i}=e;return(0,r.jsx)(o,{ref:t,decorative:n,orientation:s,className:(0,c.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),...i})});d.displayName=o.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[73,786,769,353,644,6,375,712,64,483,634,441,684,358],()=>t(773)),_N_E=e.O()}]);