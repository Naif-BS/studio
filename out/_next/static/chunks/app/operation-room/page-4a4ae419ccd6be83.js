(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[372],{255:(e,t,a)=>{"use strict";function r(e){let{moduleIds:t}=e;return null}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"PreloadChunks",{enumerable:!0,get:function(){return r}}),a(5155),a(7650),a(5744),a(589)},283:(e,t,a)=>{"use strict";a.d(t,{A:()=>d,AuthProvider:()=>o});var r=a(5155),s=a(2115),i=a(5695),n=a(7481);let l=(0,s.createContext)(void 0),o=e=>{let{children:t}=e,[a,o]=(0,s.useState)(null),[d,c]=(0,s.useState)(!0),u=(0,i.useRouter)(),{toast:m}=(0,n.dj)();(0,s.useEffect)(()=>{c(!0);try{let e=localStorage.getItem("mediaScopeUser");if(e){let t=JSON.parse(e);t?(t.displayName&&""!==t.displayName.trim()||(t.displayName=(t.email?t.email.split("@")[0].trim():"")||"User"),t.displayName||(t.displayName="User"),t.photoURL="https://placehold.co/100x100.png?text=".concat((t.displayName[0]||"U").toUpperCase()),o(t)):o(null)}}catch(e){console.error("Failed to load user from localStorage:",e),localStorage.removeItem("mediaScopeUser"),o(null)}finally{c(!1)}},[]);let f=async(e,t)=>{c(!0);try{await new Promise(e=>setTimeout(e,1e3));let t=e||"user@example.com",a=t.split("@")[0].trim();a||(a="User");let r=a,s={uid:"mock-user-123",email:t,displayName:r,photoURL:"https://placehold.co/100x100.png?text=".concat((r[0]||"U").toUpperCase()),emailVerified:!0,isAnonymous:!1,metadata:{},providerData:[],providerId:"password",refreshToken:"mock-refresh-token",tenantId:null,delete:async()=>{},getIdToken:async()=>"mock-id-token",getIdTokenResult:async()=>({token:"mock-id-token",claims:{},expirationTime:"",issuedAtTime:"",signInProvider:null,signInSecondFactor:null}),reload:async()=>{},toJSON:()=>({})};o(s),localStorage.setItem("mediaScopeUser",JSON.stringify(s)),m({title:"Sign In Successful (Mock)",description:"Redirecting to your dashboard...",variant:"default"}),u.push("/dashboard")}catch(e){console.error("Login process failed:",e),m({title:"Sign In Failed (Mock)",description:"Could not sign in at this time. Please try again later.",variant:"destructive"})}finally{c(!1)}},p=async()=>{c(!0);try{await new Promise(e=>setTimeout(e,500)),o(null),localStorage.removeItem("mediaScopeUser"),m({title:"Signed Out",description:"You have been successfully signed out.",variant:"default"}),u.push("/login")}catch(e){console.error("Logout process failed:",e),m({title:"Sign Out Failed",description:"Could not sign out at this time.",variant:"destructive"})}finally{c(!1)}};return(0,r.jsx)(l.Provider,{value:{user:a,isAuthenticated:!!a,isLoading:d,login:f,logout:p},children:t})},d=()=>{let e=(0,s.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},773:(e,t,a)=>{Promise.resolve().then(a.bind(a,8058))},2146:(e,t,a)=>{"use strict";function r(e){let{reason:t,children:a}=e;return a}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"BailoutToCSR",{enumerable:!0,get:function(){return r}}),a(5262)},4054:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{bindSnapshot:function(){return n},createAsyncLocalStorage:function(){return i},createSnapshot:function(){return l}});let a=Object.defineProperty(Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available"),"__NEXT_ERROR_CODE",{value:"E504",enumerable:!1,configurable:!0});class r{disable(){throw a}getStore(){}run(){throw a}exit(){throw a}enterWith(){throw a}static bind(e){return e}}let s="undefined"!=typeof globalThis&&globalThis.AsyncLocalStorage;function i(){return s?new s:new r}function n(e){return s?s.bind(e):r.bind(e)}function l(){return s?s.snapshot():function(e,...t){return e(...t)}}},5028:(e,t,a)=>{"use strict";a.d(t,{default:()=>s.a});var r=a(6645),s=a.n(r)},5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},5744:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorage",{enumerable:!0,get:function(){return r.workAsyncStorageInstance}});let r=a(7828)},6645:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s}});let r=a(8229)._(a(7357));function s(e,t){var a;let s={};"function"==typeof e&&(s.loader=e);let i={...s,...t};return(0,r.default)({...i,modules:null==(a=i.loadableGenerated)?void 0:a.modules})}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},6695:(e,t,a)=>{"use strict";a.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>o,Zp:()=>n,aR:()=>l,wL:()=>u});var r=a(5155),s=a(2115),i=a(9434);let n=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",a),...s})});n.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",a),...s})});l.displayName="CardHeader";let o=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-2xl font-bold leading-none tracking-tight",a),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",a),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",a),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",a),...s})});u.displayName="CardFooter"},7357:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return o}});let r=a(5155),s=a(2115),i=a(2146);function n(e){return{default:e&&"default"in e?e.default:e}}a(255);let l={loader:()=>Promise.resolve(n(()=>null)),loading:null,ssr:!0},o=function(e){let t={...l,...e},a=(0,s.lazy)(()=>t.loader().then(n)),o=t.loading;function d(e){let n=o?(0,r.jsx)(o,{isLoading:!0,pastDelay:!0,error:null}):null,l=!t.ssr||!!t.loading,d=l?s.Suspense:s.Fragment,c=t.ssr?(0,r.jsxs)(r.Fragment,{children:[null,(0,r.jsx)(a,{...e})]}):(0,r.jsx)(i.BailoutToCSR,{reason:"next/dynamic",children:(0,r.jsx)(a,{...e})});return(0,r.jsx)(d,{...l?{fallback:n}:{},children:c})}return d.displayName="LoadableComponent",d}},7828:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"workAsyncStorageInstance",{enumerable:!0,get:function(){return r}});let r=(0,a(4054).createAsyncLocalStorage)()},8058:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var r=a(5155),s=a(2115),i=a(1308),n=a(5028),l=a(3211),o=a(3473),d=a(3717),c=a(7481),u=a(283),m=a(5695),f=a(6695);let p=(0,a(157).A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var h=a(8856),g=a(9100);function x(){let[e,t]=(0,s.useState)([]),[x,v]=(0,s.useState)(null),[y,j]=(0,s.useState)(!0),[b,N]=(0,s.useState)(!1),{toast:w}=(0,c.dj)(),{user:S}=(0,u.A)(),P=(0,m.useSearchParams)(),k=(0,m.useRouter)(),C=P.get("ticketId"),[I,_]=(0,s.useState)({status:"",mediaMaterial:"",platform:"",searchTerm:""}),E=(0,s.useCallback)(async()=>{j(!0),await new Promise(e=>setTimeout(e,300)),t((0,o.oP)()),j(!1)},[]);(0,s.useEffect)(()=>{E()},[E]);let O=async(e,a,r)=>{if(!S)return;N(!0);let s=(0,o.iD)(e,a,r);s?(t(t=>t.map(t=>t.id===e?s:t)),(null==x?void 0:x.id)===e&&v(s),w({title:"Incident Status Updated",description:"Incident ".concat(s.serialNumber," status changed to ").concat(d.Z7[s.status],".")})):w({title:"Error",description:"Failed to update incident status.",variant:"destructive"}),N(!1)},R=async(a,r)=>{let s=(null==S?void 0:S.displayName)||"User",i=e.find(e=>e.id===a);if(!i){w({title:"Error",description:"Incident not found.",variant:"destructive"});return}N(!0);let n=(0,o.M8)(a,r,s);if(n){if(w({title:"Action Logged",description:"New action added to incident."}),"New"===i.status){let e=(0,o.iD)(a,"Processing","Status automatically changed to Processing by ".concat(s," after action was logged."));e?(n=e,w({title:"Incident Status Updated",description:"Incident ".concat(n.serialNumber," status automatically changed to ").concat(d.Z7[n.status],".")})):w({title:"Error",description:"Failed to automatically update incident status after logging action.",variant:"destructive"})}n&&(t(e=>e.map(e=>e.id===a?n:e)),(null==x?void 0:x.id)===a&&v(n))}else w({title:"Error",description:"Failed to log action for incident.",variant:"destructive"});N(!1)},A=(0,s.useMemo)(()=>e.filter(e=>"Closed"!==e.status).filter(e=>{var t;let a=(null===(t=I.searchTerm)||void 0===t?void 0:t.toLowerCase())||"";return(I.status&&("New"===I.status||"Processing"===I.status)?e.status===I.status:"New"===e.status||"Processing"===e.status)&&(!I.mediaMaterial||e.mediaMaterial===I.mediaMaterial)&&(!I.platform||e.platform===I.platform)&&(!I.searchTerm||e.serialNumber.toLowerCase().includes(a)||e.description.toLowerCase().includes(a))}).sort((e,t)=>{let a={New:1,Processing:2};return a[e.status]!==a[t.status]?a[e.status]-a[t.status]:new Date(e.receivedAt).getTime()-new Date(t.receivedAt).getTime()}),[e,I]);(0,s.useEffect)(()=>{if(!y){let e=x,t=C;if(x&&!A.find(e=>e.id===x.id))t=(e=A[0]||null)?e.id:null;else if(!x&&C){let a=A.find(e=>e.id===C);e=a||null,a||(t=null)}else x||C||!(A.length>0)?x&&x.id!==C?t=A.find(e=>e.id===x.id)?x.id:(e=A[0]||null)?e.id:null:!x&&0===A.length&&C&&(t=null):t=(e=A[0]).id;(null==x?void 0:x.id)!==(null==e?void 0:e.id)&&v(e);let a="/operation-room",r=t?"".concat(a,"?ticketId=").concat(t):a;r!==(C?"".concat(a,"?ticketId=").concat(C):a)&&k.replace(r,{scroll:!1})}},[A,x,y,k,C]);let M=(0,n.default)(()=>Promise.all([a.e(19),a.e(794),a.e(905)]).then(a.bind(a,6794)),{loadableGenerated:{webpack:()=>[6794]},loading:()=>(0,r.jsx)(T,{})}),T=()=>(0,r.jsxs)(f.Zp,{className:"h-full p-6 space-y-4",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsx)(h.E,{className:"h-8 w-1/3"}),(0,r.jsx)(h.E,{className:"h-6 w-20"})]}),(0,r.jsx)(h.E,{className:"h-4 w-1/2"}),(0,r.jsx)(g.w,{}),(0,r.jsx)(h.E,{className:"h-5 w-1/4 mb-1"}),(0,r.jsx)(h.E,{className:"h-4 w-full"}),(0,r.jsx)(h.E,{className:"h-4 w-full"}),(0,r.jsx)(h.E,{className:"h-4 w-3/4"}),(0,r.jsx)(g.w,{}),(0,r.jsx)(h.E,{className:"h-5 w-1/4 mb-2"}),(0,r.jsx)("div",{className:"space-y-3",children:[1,2].map(e=>(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)(h.E,{className:"h-3 w-1/4"}),(0,r.jsx)(h.E,{className:"h-3 w-1/3"})]}),(0,r.jsx)(h.E,{className:"h-4 w-full"})]},e))})]});return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"Incident Management Center"})}),(0,r.jsx)(l.A,{filters:I,onFilterChange:_}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,r.jsxs)("div",{className:"lg:col-span-2",children:[(0,r.jsx)("h2",{className:"text-xl font-bold tracking-tight mb-3",children:"Incident Queue"}),(0,r.jsx)(i.A,{tickets:A,isLoading:y,onRowClick:t=>{let a=e.find(e=>e.id===t);v(a||null),a&&C!==a.id?k.push("/operation-room?ticketId=".concat(t),{scroll:!1}):!a&&C&&k.push("/operation-room",{scroll:!1})},visibleColumns:["SerialNumber","Status","Description","Media Material","Media Platform","ReportedBy"],showActionsColumn:!0})]}),(0,r.jsxs)("div",{className:"lg:col-span-1",children:[(0,r.jsx)("h2",{className:"text-xl font-bold tracking-tight mb-3",children:"Incident Details"}),y&&!x?(0,r.jsx)(T,{}):x?(0,r.jsx)(s.Suspense,{fallback:(0,r.jsx)(T,{}),children:(0,r.jsx)(M,{ticket:x,onUpdateStatus:O,onAddAction:R,isUpdating:b})}):(0,r.jsx)(f.Zp,{className:"h-full flex items-center justify-center min-h-[300px] bg-muted/20 border-dashed",children:(0,r.jsxs)("div",{className:"text-center text-muted-foreground p-6",children:[(0,r.jsx)(p,{className:"mx-auto h-12 w-12 mb-3"}),(0,r.jsx)("p",{className:"text-lg",children:"No incident selected."}),(0,r.jsx)("p",{children:"Select an incident from the queue to view its details and manage it. If the queue appears empty, please check your filters."})]})})]})]})]})}},8856:(e,t,a)=>{"use strict";a.d(t,{E:()=>i});var r=a(5155),s=a(9434);function i(e){let{className:t,...a}=e;return(0,r.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-muted",t),...a})}},9100:(e,t,a)=>{"use strict";a.d(t,{w:()=>c});var r=a(5155),s=a(2115),i=a(3655),n="horizontal",l=["horizontal","vertical"],o=s.forwardRef((e,t)=>{var a;let{decorative:s,orientation:o=n,...d}=e,c=(a=o,l.includes(a))?o:n;return(0,r.jsx)(i.sG.div,{"data-orientation":c,...s?{role:"none"}:{"aria-orientation":"vertical"===c?c:void 0,role:"separator"},...d,ref:t})});o.displayName="Separator";var d=a(9434);let c=s.forwardRef((e,t)=>{let{className:a,orientation:s="horizontal",decorative:i=!0,...n}=e;return(0,r.jsx)(o,{ref:t,decorative:i,orientation:s,className:(0,d.cn)("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",a),...n})});c.displayName=o.displayName}},e=>{var t=t=>e(e.s=t);e.O(0,[668,644,59,375,737,812,483,634,441,684,358],()=>t(773)),_N_E=e.O()}]);